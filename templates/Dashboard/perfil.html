{% extends 'index.html' %}
{% load static %}
{% load socialaccount %}

{% block custom_css %}
<link rel="stylesheet" href="{% static 'css/perfil/perfil.css' %}" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Roboto:wght@400;500;700&display=swap" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
{% endblock %}

{% block content %}
<div class="profile-container">
  <div class="profile-header">
    <div class="profile-image">
      {% if user.image %}
      <a href="{{ user.image.url }}" data-fancybox="profile" data-caption="Imagen de perfil">
        <img src="{{ user.image.url }}" alt="Imagen de perfil" />
      </a>
      {% else %}
      <a href="{% static 'images/perfil_usuario/default.png' %}" data-fancybox="profile" data-caption="Imagen de perfil predeterminada">
        <img src="{% static 'images/perfil_usuario/default.png' %}" alt="Imagen de perfil predeterminada" />
      </a>
      {% endif %}
    </div>

    <div class="user-name">
      <h1>{{ user.first_name|upper }} {{ user.last_name|upper }}</h1>
      <div class="message-link">
        <a href="#" class="mensaje-btn">
          <i class="fas fa-envelope"></i> Mensaje
        </a>
      </div>
    </div>
  </div>

  <div class="profile-details">
    <div class="details-header">
      <h2>Detalles de usuario</h2>
      <a href="{% url 'security:editar_perfil' %}"  class="edit-link loader-load">Editar perfil</a>
    </div>

    <div class="details-section">
      <div class="details-grid">
        <div class="detail-item">
          <label>Nombre de usuario</label>
          <div class="detail-value">{{ user.username }}</div>
        </div>
        <div class="detail-item">
          <label>Nombre</label>
          <div class="detail-value">{{ user.first_name }}</div>
        </div>
        <div class="detail-item">
          <label>Apellido</label>
          <div class="detail-value">{{ user.last_name }}</div>
        </div>
        <div class="detail-item">
          <label>Correo</label>
          <div class="detail-value email-value">{{ user.email }}</div>
        </div>
        <div class="detail-item">
          <label>DNI</label>
          <div class="detail-value">{{ user.dni|default:"No especificado" }}</div>
        </div>
        <div class="detail-item">
          <label>Fecha de nacimiento</label>
          <div class="detail-value">{{ user.birth_date|default:"No especificado" }}</div>
        </div>
        <div class="detail-item">
          <label>Dirección</label>
          <div class="detail-value">{{ user.direction|default:"No especificado" }}</div>
        </div>
        <div class="detail-item">
          <label>Teléfono</label>
          <div class="detail-value">{{ user.phone|default:"No especificado" }}</div>
        </div>
      </div>
    </div>
  </div>

  <div class="profile-actions">
    <a href="{% url 'home' %}" class="btn-back">Regresar a la página principal</a>
    {% if google_connected and social_account %}
    <div class="alert alert-success">
      <p>Tu cuenta de Google está vinculada correctamente con el correo: <strong>{{ social_account.extra_data.email }}</strong></p>
      <button type="button" class="btn btn-danger btn_desvincular" data-account-id="{{ social_account.id }}">Desvincular cuenta</button>

    </div>
    {% else %}
    <div class="google-connect-section">
      <a href="{% provider_login_url 'google' process='connect' %}" class="btn btn-google loader-load">
        <i class="fab fa-google"></i> Vincular con Google
      </a>
    </div>
    {% endif %}
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="{% static 'js/perfil.js' %}"></script>

{% endblock %}
